{"version":3,"file":"index.modern.js","sources":["../src/agent/my-plugin.ts","../src/key-manager/key-management-system.ts","../src/key-manager/key-store.ts","../src/key-manager/secret-box.ts","../node_modules/daf-core/build/schemas/IIdentityManager.js","../node_modules/daf-identity-manager/build/identity-manager.js","../node_modules/daf-identity-manager/build/abstract-identity-provider.js","../node_modules/daf-identity-manager/build/abstract-identity-store.js","../node_modules/daf-identity-manager/build/index.js","../src/identity-manager/identity-provider.ts","../src/identity-manager/identity-store.ts"],"sourcesContent":["import { IAgentPlugin } from 'daf-core'\nimport { IMyAgentPlugin, IMyAgentPluginFooArgs, IContext } from '../types/IMyAgentPlugin'\n\nconst schema = { \n  components: { \n    schemas: {\n      IMyAgentPluginFooArgs: {\n        type: \"object\",\n        properties: {\n          did: {\n            type: \"string\",\n            description: \"Decentralized identifier\"\n          },\n          bar: {\n            type: \"string\",\n            description: \"bar\"\n          },\n        }\n      }\n    }, \n    methods: {\n      myPluginFoo: {\n        description: \"Does foo\",\n        arguments: {\n          \"$ref\": \"#/components/schemas/IMyAgentPluginFooArgs\"\n        },\n        returnType: {\n          type: \"string\"\n        }\n      }\n    } \n  }\n}\n\nexport class MyAgentPlugin implements IAgentPlugin {\n  \n  readonly schema = schema\n  \n  readonly methods: IMyAgentPlugin = {\n    myPluginFoo: this.myPluginFoo.bind(this)\n  }\n\n  private async myPluginFoo(args: IMyAgentPluginFooArgs, context: IContext): Promise<string> {\n    const didDoc = await context.agent.resolveDid({ didUrl: args.did })\n    console.log(didDoc)\n    return args.bar\n  }\n}","import { TKeyType, IKey, EcdsaSignature } from 'daf-core'\nimport { AbstractKeyManagementSystem } from 'daf-key-manager'\n\nexport class KeyManagementSystem extends AbstractKeyManagementSystem {\n\n  async createKey({ type }: { type: TKeyType }): Promise<Omit<IKey, 'kms'>> {\n    let key: Omit<IKey, 'kms'>\n\n    switch (type) {\n      case 'Ed25519':\n        throw Error('KeyManagementSystem createKey Ed25519 not implemented')\n        break\n      case 'Secp256k1':\n        throw Error('KeyManagementSystem createKey Secp256k1 not implemented')\n        break\n      default:\n        throw Error('Key type not supported: ' + type)\n    }\n\n    return key\n  }\n\n  async deleteKey(args: { kid: string }) {\n    throw Error('KeyManagementSystem deleteKey not implemented')\n    return true\n  }\n\n  async encryptJWE({ key, to, data }: { key: IKey; to: IKey; data: string }): Promise<string> {\n    throw Error('KeyManagementSystem encryptJWE not implemented')\n  }\n\n  async decryptJWE({ key, data }: { key: IKey; data: string }): Promise<string> {\n    throw Error('KeyManagementSystem decryptJWE not implemented')\n  }\n\n  async signEthTX({ key, transaction }: { key: IKey; transaction: object }): Promise<string> {\n    throw Error('KeyManagementSystem signEthTX not implemented')\n  }\n\n  async signJWT({ key, data }: { key: IKey; data: string }): Promise<EcdsaSignature> {\n    throw Error('KeyManagementSystem signJWT not implemented')\n  }\n}\n","import { IKey } from 'daf-core'\nimport { AbstractKeyStore } from 'daf-key-manager'\n\nexport class KeyStore extends AbstractKeyStore {\n  async get({ kid }: { kid: string }): Promise<IKey> {\n    throw Error('KeyStore get not implemented')\n  }\n\n  async delete({ kid }: { kid: string }) {\n    throw Error('KeyStore delete not implemented')\n    return true\n  }\n\n  async import(args: IKey) {\n    throw Error('KeyStore import not implemented')\n    return true\n  }\n}\n","import { AbstractSecretBox } from 'daf-key-manager'\n\nexport class SecretBox extends AbstractSecretBox {\n  constructor(private secretKey: string) {\n    super()\n    if (!secretKey) {\n      throw Error('Secret key is required')\n    }\n  }\n\n  async encrypt(message: string): Promise<string> {\n    throw Error('SecretBox encrypt not implemented')\n  }\n\n  async decrypt(encryptedMessageHex: string): Promise<string> {\n    throw Error('SecretBox decrypt not implemented')\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = {\n    \"components\": {\n        \"schemas\": {\n            \"IIdentityManagerAddKeyArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    },\n                    \"key\": {\n                        \"$ref\": \"#/components/schemas/IKey\",\n                        \"description\": \"Key object\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"key\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerAddKey | identityManagerAddKey}\"\n            },\n            \"IKey\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"kid\": {\n                        \"type\": \"string\",\n                        \"description\": \"Key ID\"\n                    },\n                    \"kms\": {\n                        \"type\": \"string\",\n                        \"description\": \"Key Management System\"\n                    },\n                    \"type\": {\n                        \"$ref\": \"#/components/schemas/TKeyType\",\n                        \"description\": \"Key type\"\n                    },\n                    \"publicKeyHex\": {\n                        \"type\": \"string\",\n                        \"description\": \"Public key\"\n                    },\n                    \"privateKeyHex\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Private key\"\n                    },\n                    \"meta\": {\n                        \"anyOf\": [\n                            {\n                                \"type\": \"object\"\n                            },\n                            {\n                                \"type\": \"null\"\n                            }\n                        ],\n                        \"description\": \"Optional. Key metadata. Can be used to store auth data to access remote kms\"\n                    }\n                },\n                \"required\": [\n                    \"kid\",\n                    \"kms\",\n                    \"type\",\n                    \"publicKeyHex\"\n                ],\n                \"description\": \"Cryptographic key\"\n            },\n            \"TKeyType\": {\n                \"type\": \"string\",\n                \"enum\": [\n                    \"Ed25519\",\n                    \"Secp256k1\"\n                ],\n                \"description\": \"Cryptographic key type\"\n            },\n            \"IIdentityManagerAddServiceArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    },\n                    \"service\": {\n                        \"$ref\": \"#/components/schemas/IService\",\n                        \"description\": \"Service object\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"service\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerAddService | identityManagerAddService}\"\n            },\n            \"IService\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"id\": {\n                        \"type\": \"string\",\n                        \"description\": \"ID\"\n                    },\n                    \"type\": {\n                        \"type\": \"string\",\n                        \"description\": \"Service type\"\n                    },\n                    \"serviceEndpoint\": {\n                        \"type\": \"string\",\n                        \"description\": \"Endpoint URL\"\n                    },\n                    \"description\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Description\"\n                    }\n                },\n                \"required\": [\n                    \"id\",\n                    \"type\",\n                    \"serviceEndpoint\"\n                ],\n                \"description\": \"Identity service\"\n            },\n            \"IIdentityManagerCreateIdentityArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Identity alias. Can be used to reference an object in an external system\"\n                    },\n                    \"provider\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Identity provider\"\n                    },\n                    \"kms\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Key Management System\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerCreateIdentity | identityManagerCreateIdentity}\"\n            },\n            \"IIdentity\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"Decentralized identifier\"\n                    },\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Identity alias. Can be used to reference an object in an external system\"\n                    },\n                    \"provider\": {\n                        \"type\": \"string\",\n                        \"description\": \"Identity provider name\"\n                    },\n                    \"controllerKeyId\": {\n                        \"type\": \"string\",\n                        \"description\": \"Controller key id\"\n                    },\n                    \"keys\": {\n                        \"type\": \"array\",\n                        \"items\": {\n                            \"$ref\": \"#/components/schemas/IKey\"\n                        },\n                        \"description\": \"Array of managed keys\"\n                    },\n                    \"services\": {\n                        \"type\": \"array\",\n                        \"items\": {\n                            \"$ref\": \"#/components/schemas/IService\"\n                        },\n                        \"description\": \"Array of services\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"provider\",\n                    \"keys\",\n                    \"services\"\n                ],\n                \"description\": \"Identity interface\"\n            },\n            \"IIdentityManagerDeleteIdentityArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    }\n                },\n                \"required\": [\n                    \"did\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerDeleteIdentity | identityManagerDeleteIdentity}\"\n            },\n            \"IIdentityManagerGetIdentitiesArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Alias\"\n                    },\n                    \"provider\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Provider\"\n                    }\n                },\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerGetIdentities | identityManagerGetIdentities}\"\n            },\n            \"IIdentityManagerGetIdentityArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    }\n                },\n                \"required\": [\n                    \"did\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerGetIdentity | identityManagerGetIdentity}\"\n            },\n            \"IIdentityManagerGetIdentityByAliasArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Alias\"\n                    },\n                    \"provider\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional provider\"\n                    }\n                },\n                \"required\": [\n                    \"alias\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerGetIdentityByAlias | identityManagerGetIdentityByAlias}\"\n            },\n            \"IIdentityManagerGetOrCreateIdentityArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Identity alias. Can be used to reference an object in an external system\"\n                    },\n                    \"provider\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Identity provider\"\n                    },\n                    \"kms\": {\n                        \"type\": \"string\",\n                        \"description\": \"Optional. Key Management System\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"required\": [\n                    \"alias\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerGetOrCreateIdentity | identityManagerGetOrCreateIdentity}\"\n            },\n            \"IIdentityManagerRemoveKeyArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    },\n                    \"kid\": {\n                        \"type\": \"string\",\n                        \"description\": \"Key ID\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"kid\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerRemoveKey | identityManagerRemoveKey}\"\n            },\n            \"IIdentityManagerRemoveServiceArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"DID\"\n                    },\n                    \"id\": {\n                        \"type\": \"string\",\n                        \"description\": \"Service ID\"\n                    },\n                    \"options\": {\n                        \"type\": \"object\",\n                        \"description\": \"Optional. Identity provider specific options\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"id\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerRemoveService | identityManagerRemoveService}\"\n            },\n            \"IIdentityManagerSetAliasArgs\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"did\": {\n                        \"type\": \"string\",\n                        \"description\": \"Required. DID\"\n                    },\n                    \"alias\": {\n                        \"type\": \"string\",\n                        \"description\": \"Required. Identity alias\"\n                    }\n                },\n                \"required\": [\n                    \"did\",\n                    \"alias\"\n                ],\n                \"description\": \"Input arguments for {@link IIdentityManager.identityManagerSetAlias | identityManagerSetAlias}\"\n            }\n        },\n        \"methods\": {\n            \"identityManagerAddKey\": {\n                \"description\": \"Adds a key to a DID Document\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerAddKeyArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"object\"\n                }\n            },\n            \"identityManagerAddService\": {\n                \"description\": \"Adds a service to a DID Document\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerAddServiceArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"object\"\n                }\n            },\n            \"identityManagerCreateIdentity\": {\n                \"description\": \"Creates and returns a new identity\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerCreateIdentityArgs\"\n                },\n                \"returnType\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                }\n            },\n            \"identityManagerDeleteIdentity\": {\n                \"description\": \"Deletes identity\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerDeleteIdentityArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"boolean\"\n                }\n            },\n            \"identityManagerGetIdentities\": {\n                \"description\": \"Returns a list of managed identities\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerGetIdentitiesArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/components/schemas/IIdentity\"\n                    }\n                }\n            },\n            \"identityManagerGetIdentity\": {\n                \"description\": \"Returns a specific identity\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerGetIdentityArgs\"\n                },\n                \"returnType\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                }\n            },\n            \"identityManagerGetIdentityByAlias\": {\n                \"description\": \"Returns a specific identity by alias\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerGetIdentityByAliasArgs\"\n                },\n                \"returnType\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                }\n            },\n            \"identityManagerGetOrCreateIdentity\": {\n                \"description\": \"Returns an existing identity or creates a new one for a specific alias\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerGetOrCreateIdentityArgs\"\n                },\n                \"returnType\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                }\n            },\n            \"identityManagerGetProviders\": {\n                \"description\": \"Returns a list of available identity providers\",\n                \"arguments\": {\n                    \"type\": \"object\"\n                },\n                \"returnType\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"string\"\n                    }\n                }\n            },\n            \"identityManagerImportIdentity\": {\n                \"description\": \"Imports identity\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                },\n                \"returnType\": {\n                    \"$ref\": \"#/components/schemas/IIdentity\"\n                }\n            },\n            \"identityManagerRemoveKey\": {\n                \"description\": \"Removes a key from a DID Document\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerRemoveKeyArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"object\"\n                }\n            },\n            \"identityManagerRemoveService\": {\n                \"description\": \"Removes a service from a DID Document\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerRemoveServiceArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"object\"\n                }\n            },\n            \"identityManagerSetAlias\": {\n                \"description\": \"Sets identity alias\",\n                \"arguments\": {\n                    \"$ref\": \"#/components/schemas/IIdentityManagerSetAliasArgs\"\n                },\n                \"returnType\": {\n                    \"type\": \"boolean\"\n                }\n            }\n        }\n    }\n};\n//# sourceMappingURL=IIdentityManager.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IdentityManager = void 0;\nvar IIdentityManager_1 = __importDefault(require(\"daf-core/build/schemas/IIdentityManager\"));\n/**\n * Agent plugin that implements {@link daf-core#IIdentityManager} interface\n * @public\n */\nvar IdentityManager = /** @class */ (function () {\n    function IdentityManager(options) {\n        this.schema = IIdentityManager_1.default;\n        this.providers = options.providers;\n        this.defaultProvider = options.defaultProvider;\n        this.store = options.store;\n        this.methods = {\n            identityManagerGetProviders: this.identityManagerGetProviders.bind(this),\n            identityManagerGetIdentities: this.identityManagerGetIdentities.bind(this),\n            identityManagerGetIdentity: this.identityManagerGetIdentity.bind(this),\n            identityManagerGetIdentityByAlias: this.identityManagerGetIdentityByAlias.bind(this),\n            identityManagerCreateIdentity: this.identityManagerCreateIdentity.bind(this),\n            identityManagerSetAlias: this.identityManagerSetAlias.bind(this),\n            identityManagerGetOrCreateIdentity: this.identityManagerGetOrCreateIdentity.bind(this),\n            identityManagerImportIdentity: this.identityManagerImportIdentity.bind(this),\n            identityManagerDeleteIdentity: this.identityManagerDeleteIdentity.bind(this),\n            identityManagerAddKey: this.identityManagerAddKey.bind(this),\n            identityManagerRemoveKey: this.identityManagerRemoveKey.bind(this),\n            identityManagerAddService: this.identityManagerAddService.bind(this),\n            identityManagerRemoveService: this.identityManagerRemoveService.bind(this),\n        };\n    }\n    IdentityManager.prototype.getProvider = function (name) {\n        var provider = this.providers[name];\n        if (!provider)\n            throw Error('Identity provider does not exist: ' + name);\n        return provider;\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerGetProviders} */\n    IdentityManager.prototype.identityManagerGetProviders = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Object.keys(this.providers)];\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerGetIdentities} */\n    IdentityManager.prototype.identityManagerGetIdentities = function (args) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.store.list(args)];\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerGetIdentity} */\n    IdentityManager.prototype.identityManagerGetIdentity = function (_a) {\n        var did = _a.did;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                return [2 /*return*/, this.store.get({ did: did })];\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerGetIdentityByAlias} */\n    IdentityManager.prototype.identityManagerGetIdentityByAlias = function (_a) {\n        var alias = _a.alias, provider = _a.provider;\n        return __awaiter(this, void 0, void 0, function () {\n            var providerName;\n            return __generator(this, function (_b) {\n                providerName = provider || this.defaultProvider;\n                return [2 /*return*/, this.store.get({ alias: alias, provider: providerName })];\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerCreateIdentity} */\n    IdentityManager.prototype.identityManagerCreateIdentity = function (args, context) {\n        return __awaiter(this, void 0, void 0, function () {\n            var providerName, existingIdentity, e_1, identityProvider, partialIdentity, identity;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        providerName = (args === null || args === void 0 ? void 0 : args.provider) || this.defaultProvider;\n                        if (!((args === null || args === void 0 ? void 0 : args.alias) !== undefined)) return [3 /*break*/, 5];\n                        existingIdentity = void 0;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, this.store.get({ alias: args.alias, provider: providerName })];\n                    case 2:\n                        existingIdentity = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 4:\n                        if (existingIdentity) {\n                            throw Error(\"Identity with alias: \" + args.alias + \", provider: \" + providerName + \" already exists\");\n                        }\n                        _a.label = 5;\n                    case 5:\n                        identityProvider = this.getProvider(providerName);\n                        return [4 /*yield*/, identityProvider.createIdentity({ kms: args === null || args === void 0 ? void 0 : args.kms, alias: args === null || args === void 0 ? void 0 : args.alias, options: args === null || args === void 0 ? void 0 : args.options }, context)];\n                    case 6:\n                        partialIdentity = _a.sent();\n                        identity = __assign(__assign({}, partialIdentity), { provider: providerName });\n                        if (args === null || args === void 0 ? void 0 : args.alias) {\n                            identity.alias = args.alias;\n                        }\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 7:\n                        _a.sent();\n                        return [2 /*return*/, identity];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerGetOrCreateIdentity} */\n    IdentityManager.prototype.identityManagerGetOrCreateIdentity = function (_a, context) {\n        var provider = _a.provider, alias = _a.alias, kms = _a.kms, options = _a.options;\n        return __awaiter(this, void 0, void 0, function () {\n            var providerName, identity, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _c.trys.push([0, 2, , 3]);\n                        providerName = provider || this.defaultProvider;\n                        return [4 /*yield*/, this.store.get({ alias: alias, provider: providerName })];\n                    case 1:\n                        identity = _c.sent();\n                        return [2 /*return*/, identity];\n                    case 2:\n                        _b = _c.sent();\n                        return [2 /*return*/, this.identityManagerCreateIdentity({ provider: provider, alias: alias, kms: kms, options: options }, context)];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerSetAlias} */\n    IdentityManager.prototype.identityManagerSetAlias = function (_a, context) {\n        var did = _a.did, alias = _a.alias;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        identity.alias = alias;\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 2: return [2 /*return*/, _b.sent()];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerImportIdentity} */\n    IdentityManager.prototype.identityManagerImportIdentity = function (identity, context) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, _b, key, e_2_1;\n            var e_2, _c;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _d.trys.push([0, 5, 6, 7]);\n                        _a = __values(identity.keys), _b = _a.next();\n                        _d.label = 1;\n                    case 1:\n                        if (!!_b.done) return [3 /*break*/, 4];\n                        key = _b.value;\n                        return [4 /*yield*/, context.agent.keyManagerImportKey(key)];\n                    case 2:\n                        _d.sent();\n                        _d.label = 3;\n                    case 3:\n                        _b = _a.next();\n                        return [3 /*break*/, 1];\n                    case 4: return [3 /*break*/, 7];\n                    case 5:\n                        e_2_1 = _d.sent();\n                        e_2 = { error: e_2_1 };\n                        return [3 /*break*/, 7];\n                    case 6:\n                        try {\n                            if (_b && !_b.done && (_c = _a.return)) _c.call(_a);\n                        }\n                        finally { if (e_2) throw e_2.error; }\n                        return [7 /*endfinally*/];\n                    case 7: return [4 /*yield*/, this.store.import(identity)];\n                    case 8:\n                        _d.sent();\n                        return [2 /*return*/, identity];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerDeleteIdentity} */\n    IdentityManager.prototype.identityManagerDeleteIdentity = function (_a, context) {\n        var did = _a.did;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity, provider;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        provider = this.getProvider(identity.provider);\n                        return [4 /*yield*/, provider.deleteIdentity(identity, context)];\n                    case 2:\n                        _b.sent();\n                        if (!(identity.services.length > 0)) return [3 /*break*/, 4];\n                        identity.services = [];\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 3:\n                        _b.sent();\n                        _b.label = 4;\n                    case 4: return [2 /*return*/, this.store.delete({ did: did })];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerAddKey} */\n    IdentityManager.prototype.identityManagerAddKey = function (_a, context) {\n        var did = _a.did, key = _a.key, options = _a.options;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity, provider, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        provider = this.getProvider(identity.provider);\n                        return [4 /*yield*/, provider.addKey({ identity: identity, key: key, options: options }, context)];\n                    case 2:\n                        result = _b.sent();\n                        identity.keys.push(key);\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 3:\n                        _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerRemoveKey} */\n    IdentityManager.prototype.identityManagerRemoveKey = function (_a, context) {\n        var did = _a.did, kid = _a.kid, options = _a.options;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity, provider, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        provider = this.getProvider(identity.provider);\n                        return [4 /*yield*/, provider.removeKey({ identity: identity, kid: kid, options: options }, context)];\n                    case 2:\n                        result = _b.sent();\n                        identity.keys = identity.keys.filter(function (k) { return k.kid !== kid; });\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 3:\n                        _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerAddService} */\n    IdentityManager.prototype.identityManagerAddService = function (_a, context) {\n        var did = _a.did, service = _a.service, options = _a.options;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity, provider, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        provider = this.getProvider(identity.provider);\n                        return [4 /*yield*/, provider.addService({ identity: identity, service: service, options: options }, context)];\n                    case 2:\n                        result = _b.sent();\n                        identity.services.push(service);\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 3:\n                        _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    /** {@inheritDoc daf-core#IIdentityManager.identityManagerRemoveService} */\n    IdentityManager.prototype.identityManagerRemoveService = function (_a, context) {\n        var did = _a.did, id = _a.id, options = _a.options;\n        return __awaiter(this, void 0, void 0, function () {\n            var identity, provider, result;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.store.get({ did: did })];\n                    case 1:\n                        identity = _b.sent();\n                        provider = this.getProvider(identity.provider);\n                        return [4 /*yield*/, provider.removeService({ identity: identity, id: id, options: options }, context)];\n                    case 2:\n                        result = _b.sent();\n                        identity.services = identity.services.filter(function (s) { return s.id !== id; });\n                        return [4 /*yield*/, this.store.import(identity)];\n                    case 3:\n                        _b.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    return IdentityManager;\n}());\nexports.IdentityManager = IdentityManager;\n//# sourceMappingURL=identity-manager.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AbstractIdentityProvider = void 0;\n/**\n * An abstract class for the {@link daf-identity-manager#IdentityManager} identity providers\n * @public\n */\nvar AbstractIdentityProvider = /** @class */ (function () {\n    function AbstractIdentityProvider() {\n    }\n    return AbstractIdentityProvider;\n}());\nexports.AbstractIdentityProvider = AbstractIdentityProvider;\n//# sourceMappingURL=abstract-identity-provider.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AbstractIdentityStore = void 0;\n/**\n * An abstract class for the {@link daf-identity-manager#IdentityManager} identity store\n * @public\n */\nvar AbstractIdentityStore = /** @class */ (function () {\n    function AbstractIdentityStore() {\n    }\n    return AbstractIdentityStore;\n}());\nexports.AbstractIdentityStore = AbstractIdentityStore;\n//# sourceMappingURL=abstract-identity-store.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AbstractIdentityStore = exports.AbstractIdentityProvider = exports.IdentityManager = void 0;\n/**\n * Provides a {@link daf-identity-manager#IdentityManager | plugin} for the {@link daf-core#Agent} that implements {@link daf-core#IIdentityManager} interface\n *\n * @packageDocumentation\n */\nvar identity_manager_1 = require(\"./identity-manager\");\nObject.defineProperty(exports, \"IdentityManager\", { enumerable: true, get: function () { return identity_manager_1.IdentityManager; } });\nvar abstract_identity_provider_1 = require(\"./abstract-identity-provider\");\nObject.defineProperty(exports, \"AbstractIdentityProvider\", { enumerable: true, get: function () { return abstract_identity_provider_1.AbstractIdentityProvider; } });\nvar abstract_identity_store_1 = require(\"./abstract-identity-store\");\nObject.defineProperty(exports, \"AbstractIdentityStore\", { enumerable: true, get: function () { return abstract_identity_store_1.AbstractIdentityStore; } });\n//# sourceMappingURL=index.js.map","import { IIdentity, IKey, IService, IAgentContext, IKeyManager } from 'daf-core'\nimport { AbstractIdentityProvider } from 'daf-identity-manager'\n\ntype IContext = IAgentContext<IKeyManager>\n\nexport class IdentityProvider extends AbstractIdentityProvider {\n  private defaultKms: string\n\n  constructor(options: { defaultKms: string }) {\n    super()\n    this.defaultKms = options.defaultKms\n  }\n\n  async createIdentity(\n    { kms, alias }: { kms?: string; alias?: string },\n    context: IContext,\n  ): Promise<Omit<IIdentity, 'provider'>> {\n    throw Error('IdentityProvider createIdentity not implemented')\n  }\n\n  async deleteIdentity(identity: IIdentity, context: IContext): Promise<boolean> {\n    throw Error('IdentityProvider deleteIdentity not implemented')\n    return true\n  }\n\n  async addKey(\n    { identity, key, options }: { identity: IIdentity; key: IKey; options?: any },\n    context: IContext,\n  ): Promise<any> {\n    throw Error('IdentityProvider addKey not implemented')\n    return { success: true }\n  }\n\n  async addService(\n    { identity, service, options }: { identity: IIdentity; service: IService; options?: any },\n    context: IContext,\n  ): Promise<any> {\n    throw Error('IdentityProvider addService not implemented')\n    return { success: true }\n  }\n\n  async removeKey(\n    args: { identity: IIdentity; kid: string; options?: any },\n    context: IContext,\n  ): Promise<any> {\n    throw Error('IdentityProvider removeKey not implemented')\n    return { success: true }\n  }\n\n  async removeService(\n    args: { identity: IIdentity; id: string; options?: any },\n    context: IContext,\n  ): Promise<any> {\n    throw Error('IdentityProvider removeService not implemented')\n    return { success: true }\n  }\n}\n","import { IIdentity } from 'daf-core'\nimport { AbstractIdentityStore } from 'daf-identity-manager'\n\nexport class IdentityStore extends AbstractIdentityStore {\n  async get({ did, alias, provider }: { did: string; alias: string; provider: string }): Promise<IIdentity> {\n    throw Error('IdentityStore get not implemented')\n  }\n\n  async delete({ did }: { did: string }) {\n    throw Error('IdentityStore delete not implemented')\n    return true\n  }\n\n  async import(args: IIdentity) {\n    throw Error('IdentityStore import not implemented')\n    return true\n  }\n\n  async list(args: { alias?: string; provider?: string }): Promise<IIdentity[]> {\n    throw Error('IdentityStore list not implemented')\n  }\n}\n"],"names":["schema","components","schemas","IMyAgentPluginFooArgs","type","properties","did","description","bar","methods","myPluginFoo","arguments","$ref","returnType","MyAgentPlugin","constructor","this","bind","[object Object]","args","context","didDoc","agent","resolveDid","didUrl","console","log","KeyManagementSystem","AbstractKeyManagementSystem","Error","KeyStore","AbstractKeyStore","SecretBox","AbstractSecretBox","secretKey","super","message","encryptedMessageHex","Object","defineProperty","exports","value","IIdentityManagerAddKeyArgs","key","options","required","IKey","kid","kms","publicKeyHex","privateKeyHex","meta","anyOf","TKeyType","enum","IIdentityManagerAddServiceArgs","service","IService","id","serviceEndpoint","IIdentityManagerCreateIdentityArgs","alias","provider","IIdentity","controllerKeyId","keys","items","services","IIdentityManagerDeleteIdentityArgs","IIdentityManagerGetIdentitiesArgs","IIdentityManagerGetIdentityArgs","IIdentityManagerGetIdentityByAliasArgs","IIdentityManagerGetOrCreateIdentityArgs","IIdentityManagerRemoveKeyArgs","IIdentityManagerRemoveServiceArgs","IIdentityManagerSetAliasArgs","identityManagerAddKey","identityManagerAddService","identityManagerCreateIdentity","identityManagerDeleteIdentity","identityManagerGetIdentities","identityManagerGetIdentity","identityManagerGetIdentityByAlias","identityManagerGetOrCreateIdentity","identityManagerGetProviders","identityManagerImportIdentity","identityManagerRemoveKey","identityManagerRemoveService","identityManagerSetAlias","__assign","assign","t","s","i","n","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__importDefault","mod","__esModule","default","IIdentityManager_1","require$$0","IdentityManager","providers","defaultProvider","store","getProvider","name","_a","list","_b","get","providerName","existingIdentity","partialIdentity","identity","undefined","createIdentity","import","_c","e_2_1","e_2","_d","keyManagerImportKey","error","deleteIdentity","delete","addKey","removeKey","filter","k","addService","removeService","enumerable","identity_manager_1","abstract_identity_provider_1","AbstractIdentityProvider","abstract_identity_store_1","AbstractIdentityStore","IdentityProvider","defaultKms","IdentityStore"],"mappings":"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"}